<!DOCTYPE html>
<html>
<head>

<title>WhatYouDid! Timer</title>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>

<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>




</head>
<body>

<div ng-app="wyd" ng-controller="wCon">
	<div id="clock"><h1>{{time}}</h1></div>
	
	<div class="form-group">
		<textarea class="form-control" id="text"></textarea>
		<button class="btn form--control" id="add">Add</button>
		<button class="btn form--control" id="save">Save</button>
		<button class="btn form--control" id="clear">Clear</button>
		<button class="btn form--control" id="upDown">Up / Down</button>
		<button class="btn form--control" id="Remove">Remove Last</button>
		<button class="btn form--control" id="Recall">Recall Date</button>
	</div>
	
	<div class="panel panel-default">
	<h2>{{day}}</h2>
	
		<div id="output">
			<div ng-repeat="x in items" >{{x}}</div>
		</div>
	</div>
	
</div>


<script>


	

	
	var wydApp = angular.module("wyd", []);
	wydApp.controller("wCon",function($scope, $interval){
		
		let updn = 1;
		$scope.items = [];
		

		timer = () => { 
			$scope.time = Date().split(" ")[4].split(":").slice(0,2).join(":");
			let dt = new Date();
			$scope.day = (dt.getMonth() + 1) + "-" + dt.getDate() + "-" + dt.getFullYear();
			
			
		}
		
		timer();
		$interval(timer, 1000);
		
		
			$("#add").click( () => {
		
				let txt = $("#text").val();
				
		
				//if there is text in textarea, append text to list & clear textarea
				if ( txt.length > 1 ){
				
				
					
					if ( updn === 1){
						$scope.items.push( $scope.time + ") " + txt);  // store things did in items array
					} else {
						$scope.items.unshift( $scope.time + ") " + txt);  
					}
					
					$("#text").val(" ");
				}
			});
			
			$("#clear").click( () => {
				$("#output").empty();
				$scope.items = [];
			});
			
			$("#upDown").click( () => {
			
				updn *= -1;  //Toggle value of updn to toggle direction of array appending for items array.
				
				$scope.items.reverse();
			});
		
		
		$("#save").click( () => {
			store($scope.day, $scope.items);
		});
		
		$("#Remove").click( () => {
		
			let conf = confirm("Are you sure?");
			
			if (conf){
		
				if ( updn === 1){
					$scope.items.pop(); 
				} else {
					$scope.items.shift();  
				}
				
			}	
			
		});
		
		$("#Recall").click( () => {
			let rDate = prompt("Please enter a date to recall a list:", "");
			
			if (rDate){
				
				localStorage.getItem(rDate);
				
			
			} else {
				return;
			}
		});
		
	});
	
	
		function store(date, data){
			localStorage.setItem(date, data);
		}

		
	


	
</script>

</body>
</html>